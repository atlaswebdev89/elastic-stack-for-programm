# NGINX Stream Proxy Logs
- type: filestream
  id: nginx-stream-connect
  enabled: true
  paths:
    - /var/log/host_logs/nginx/logstash/stream/logstash-connect.log
  fields:
    log_source: "nginx_stream_proxy"
    log_type: "connection"
    component: "stream_proxy"
    protocol: "tcp_udp"
  fields_under_root: true
  tags: ["nginx", "stream", "connect", "proxy", "logstash"]
  exclude_lines: ['disconnected']
  include_lines: ['info']

  parsers:
    - multiline:
        pattern: '^[0-9]{4}/[0-9]{2}/[0-9]{2}'
        negate: true
        match: after

- type: filestream
  id: nginx-stream-error
  enabled: true
  paths:
    - /var/log/host_logs/nginx/logstash/stream/logstash-error.log
  fields:
    log_source: "nginx_stream_proxy"
    log_type: "error"
    component: "stream_proxy"
    severity: "error"
  fields_under_root: true
  tags: ["nginx", "stream", "error", "proxy", "logstash"]